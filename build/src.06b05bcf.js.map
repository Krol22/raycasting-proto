{"version":3,"sources":["src/map.js","src/index.js"],"names":["map","mapValue","input","a","b","c","d","ctx","document","querySelector","getContext","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","cameraX","rayDirX","rayDirY","image","posX","posY","dirX","dirY","offset","planeX","planeY","w","h","update","x","mapX","Math","floor","mapY","deltaDistX","sqrt","deltaDistY","perpWallDist","stepX","stepY","sideDistX","sideDistY","side","hitWalls","push","value","reverse","forEach","lineHeight","color","wallX","abs","drawStart","drawEnd","fillStyle","fillRect","textureSize","textureX","drawImage","val2","loop","window","requestAnimationFrame","rotSpeed","addEventListener","e","key","oldDirX","cos","sin","oldPlaneX","loadAsset","src","Promise","resolve","asset","Image","onload","then"],"mappings":";AAAO,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,SAAA,EAAA,IAAMA,EAAM,CACjB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAC/C,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE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","file":"src.06b05bcf.js","sourceRoot":"..","sourcesContent":["export const map = [\n  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\n];\n","import { map } from './map';\n\n// const MAP_WIDTH = 24;\n// const MAP_HEIGHT = 24;\n//\nconst mapValue = (input, a, b, c, d) => {\n  return c + ((d - c) / (b - a)) * (input - a);\n};\n\nconst ctx = document.querySelector('#game-canvas').getContext('2d');\nctx.webkitImageSmoothingEnabled = false;\nctx.mozImageSmoothingEnabled = false;\n\nlet posX = 22;\nlet posY = 10;\nlet dirX = -1;\nlet dirY = 0;\n\nlet offset = 0;\n\nlet planeX = 0;\nlet planeY = 0.66;\n\n// let time = 0;\n// let oldTime = 0;\n//\nlet cameraX, rayDirX, rayDirY;\n\nlet image;\n\nlet w = 800;\nlet h = 400;\n\nconst update = () => {\n  // cast 'RAYS';\n  for (let x = 0; x < w; x++) {\n    cameraX = 2 * x / w - 1; \n\n    // get ray direction\n    rayDirX = dirX + planeX * cameraX;\n    rayDirY = dirY + planeY * cameraX;\n\n    // -------- DDA ---------\n\n    // get player coords;\n    const mapX = Math.floor(posX);\n    const mapY = Math.floor(posY);\n\n    // length of ray from one x or y-side to next x or y-side\n    // let deltaDistX = Math.abs(1 / rayDirX);\n    // let deltaDistY = Math.abs(1 / rayDirY);\n    let deltaDistX = Math.sqrt(1 + (rayDirY * rayDirY) / (rayDirX * rayDirX));\n    let deltaDistY = Math.sqrt(1 + (rayDirX * rayDirX) / (rayDirY * rayDirY));\n    let perpWallDist;\n\n    // direction of step\n    let stepX;\n    let stepY;\n\n    // length of ray from current position to next x or y-side\n    let sideDistX, sideDistY;\n\n    let hit = false;\n    let side; // 0 if x-axis side was hit 1 when y-axis side was hit\n\n    // calculate step & initial sideDist,\n\n    if (rayDirX < 0) {\n      stepX = -1;\n      sideDistX = (posX - mapX) * deltaDistX;\n    } else {\n      stepX = 1;\n      sideDistX = (mapX + 1 - posX) * deltaDistX;\n    }\n    if (rayDirY < 0) {\n      stepY = -1;\n      sideDistY = (posY - mapY) * deltaDistY;\n    } else {\n      stepY = 1;\n      sideDistY = (mapY + 1 - posY) * deltaDistY;\n    } \n\n    const hitWalls = [];\n    // Actual DDA\n    while (true) {\n      if (sideDistX < sideDistY) {\n        sideDistX += deltaDistX;\n        mapX += stepX;\n        mapX = Math.floor(mapX);\n        side = 0;\n      } else {\n        sideDistY += deltaDistY;\n        mapY += stepY;\n        mapY = Math.floor(mapY);\n        side = 1;\n      }\n\n      if (map[mapX][mapY] > 0) {\n        hitWalls.push({\n          mapX,\n          mapY,\n          side,\n          value: map[mapX][mapY],\n        });\n        if (map[mapX][mapY] === 1) {\n          break;\n        }\n      }\n    }\n\n    // ------- DDA DONE -------\n\n    // Calculate distance projected on camera\n    hitWalls.reverse().forEach(({mapX, mapY, side, value}) => {\n      if (side === 0) {\n        perpWallDist = (mapX - posX + (1 - stepX) / 2) / rayDirX;\n      } else {\n        perpWallDist = (mapY - posY + (1 - stepY) / 2) / rayDirY;\n      }\n\n      // if (value === 3) {\n        // perpWallDist = perpWallDist * 4;\n      // }\n\n      // Calculate col height;\n      let lineHeight = Math.floor(Math.abs(h / perpWallDist));\n\n      // calculate lowest and highest pixel;\n      let drawStart = h / 2 + lineHeight / 2 ;\n      let drawEnd = drawStart - lineHeight;\n      // if (drawStart < 0) drawStart = 0;\n\n      if (value === 3) {\n        drawStart = h / 2 + lineHeight / 2;\n        drawEnd = drawStart - lineHeight / value; \n      }\n\n      if (value === 2) {\n        drawStart = h / 2 + lineHeight / 2;\n        drawEnd = drawStart - lineHeight * value * 1.2; \n      }\n      // let drawEnd = drawStart - 5 * 10 + 20;\n      // if (value === 3) {\n      // }\n\n      let color;\n      switch(map[mapX][mapY]) {\n        case(1): {\n          color= 'red';\n          if (side === 1) {\n            color = 'salmon';\n          }\n          break;\n        }\n        case(2): {\n          color= 'green';\n          if (side === 1) {\n            color = 'springgreen';\n          }\n          break;\n        }\n        case(3): {\n          color= 'blue';\n          if (side === 1) {\n            color = 'skyblue';\n          }\n          break;\n        }\n        case(4): {\n          color= 'white';\n          if (side === 1) {\n            color = 'whitesmoke';\n          }\n          break;\n        }\n      }\n\n      ctx.fillStyle = color;\n      ctx.fillRect(x, drawStart, 1, drawEnd - drawStart);\n\n      let wallX\n      if (side === 0) {\n        wallX = posY + perpWallDist * rayDirY;\n      } else {\n        wallX = posX + perpWallDist * rayDirX;\n      }\n\n      wallX -= Math.floor(wallX);\n\n      let textureSize = 15;\n      let textureX = Math.floor(wallX * textureSize);\n\n      if (value === 2) {\n        ctx.drawImage(image, textureX, 0, 1, textureSize, x, drawEnd, 1, lineHeight * 1.2 * value);\n      } else if (value === 3) {\n        ctx.drawImage(image, textureX, 0, 1, textureSize, x, drawEnd, 1, lineHeight / value);\n      } else {\n        ctx.drawImage(image, textureX, 0, 1, textureSize, x, drawEnd, 1, lineHeight);\n      }\n\n      const val2 = mapValue(perpWallDist, 0, 15, 0, 0.5);\n      ctx.fillStyle = `rgba(0, 0, 0, ${val2})`;\n      ctx.fillRect(x, drawStart, 1, drawEnd - drawStart);\n    });\n    // WALL TEXTURES\n\n    // FOG\n  }\n};\n\nconst loop = () => {\n  ctx.fillStyle = 'black';\n  ctx.fillRect(0, 0, 800, 400);\n  update(); \n  window.requestAnimationFrame(loop);\n};\n\nconst rotSpeed = 0.1;\n\nwindow.addEventListener('keydown', e => {\n  if (e.key === 'w') {\n    posY += dirY * 0.2;\n    posX += dirX * 0.2;\n  }\n  if (e.key === 's') {\n    posY -= dirY * 0.2;\n    posX -= dirX * 0.2;\n  }\n\n  if (e.key === 'd') {\n    const oldDirX = dirX;\n    dirX = dirX * Math.cos(-rotSpeed) - dirY * Math.sin(-rotSpeed);\n    dirY = oldDirX * Math.sin(-rotSpeed) + dirY * Math.cos(-rotSpeed);\n\n    const oldPlaneX = planeX;\n    planeX = planeX * Math.cos(-rotSpeed) - planeY * Math.sin(-rotSpeed);\n    planeY = oldPlaneX * Math.sin(-rotSpeed) + planeY * Math.cos(-rotSpeed);\n  }\n  \n  if (e.key === 'a') {\n    const oldDirX = dirX;\n    dirX = dirX * Math.cos(rotSpeed) - dirY * Math.sin(rotSpeed);\n    dirY = oldDirX * Math.sin(rotSpeed) + dirY * Math.cos(rotSpeed);\n\n    const oldPlaneX = planeX;\n    planeX = planeX * Math.cos(rotSpeed) - planeY * Math.sin(rotSpeed);\n    planeY = oldPlaneX * Math.sin(rotSpeed) + planeY * Math.cos(rotSpeed);\n\n  }\n\n  if (e.key === 'q') {\n    offset += 10;\n  } \n\n  if (e.key === 'z') {\n    offset -= 10;\n  }\n});\n\nconst loadAsset = (src) => {\n  return new Promise(resolve => {\n    const asset = new Image();\n    asset.src = src;\n    asset.onload = () => {\n      resolve(asset);\n    }\n  });\n}\n\nloadAsset('Wall.png').then((asset) => {\n  image = asset\n  window.requestAnimationFrame(loop);\n\n})\n"]}