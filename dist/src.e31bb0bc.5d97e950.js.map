{"version":3,"sources":["vector2d.js","inputManager.js","imageData.helper.js","config.js","raycastRenderer.js","index.js","../../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/hmr-runtime.js","../../../.config/yarn/global/node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Vector2d","x","y","vector","scalar","Math","sqrt","m","mag","div","angle","inRadians","PI","cos","sin","v0","v1","v2","pow","a","b","c","delta","acos","restartKeyState","key","isPressed","wasPressed","isDown","InputManager","_canvas","keys","mouseState","pos","posInCanvas","prevPos","mouse1","mouse2","init","canvasSelector","document","querySelector","_initKeyBoardEvents","_initMouseEvents","i","update","Object","forEach","keyCode","window","addEventListener","e","boundingRect","getBoundingClientRect","floor","clientX","clientY","button","getImageDataFromImage","image","canvas","createElement","ctx","getContext","width","height","imageSmoothingEnabled","drawImage","getImageData","copyPixel","sourceImageData","sx","sy","ssize","destImageData","dx","dy","dsize","alpha","sourceIndex","destIndex","addPixelToImageData","sourceData","dest","data","resolutionWidth","resolutionHeight","playerMovementSpeed","viewSkipDistance","viewDistance","viewDistanceObjectFix","viewDistanceWallFix","cameraMinY","cameraMaxY","textureSize","mapValue","input","d","RaycastRenderer","rayCastingImageData","ImageData","camera","planeX","planeY","lookY","pointingAt","playerPosition","rayDir","walls","hitWalls","length","texture","x1","y1","x2","y2","x3","y3","x4","y4","den","t","u","mapPos","len","magnitude","push","id","side","type","player","objects","position","dir","sortedObjects","texWidth","texHeight","sort","obj1","obj2","len2","obj","uDiv","vDiv","vMove","spriteX","spriteY","invDet","transformX","transformY","spriteScreenX","vMoveScreen","spriteHeight","abs","drawStartY","drawEndY","spriteWidth","drawStartX","drawEndX","element","ray","perpWallDist","drawStart","currentDist","weight","currentFloorX","currentFloorY","floorTexX","floorTexY","floorImageData","drawEnd","celingImageData","object","texX","texY","wall","isClosestWall","lineHeight","wallX","textureX","offsetDS","offsetDE","mapValueMin","mapValueMax","textureY","drawFloor","drawCeling","cameraX","castRays","visibleObjects","filter","elementsToDraw","elem1","elem2","lastElementIndex","index","drawWall","drawObject","clearRect","preparedObjects","prepareObjectToDraw","draw","putImageData","fillStyle","fillRect","pointingAtSpan","pointing","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","raycastRenderer","getCamera","mouseMove","movementY","rotSpeed","movementX","oldDirX","oldPlaneX","pointerlockvalue","removeEventListener","requestPointerLock","playerMovement","loop","innerHTML","requestAnimationFrame","loadAsset","src","console","log","Promise","resolve","asset","Image","onload","onerror","err","then","wallImageData","ammoImageData","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","handled","assets","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","getElementById","remove","stackTrace","innerText","getParents","modules","parents","k","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.e31bb0bc.5d97e950.js","sourceRoot":"..","sourcesContent":["export default class Vector2d {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  add(vector) {\n    this.x += vector.x;\n    this.y += vector.y;\n  }\n\n  static addVectors(v0, v1) {\n    return new Vector2d(v0.x + v1.x, v0.y + v1.y);\n  }\n\n  sub(vector) {\n    this.x -= vector.x;\n    this.y -= vector.y;\n  }\n\n  mul(scalar) {\n    this.x *= scalar;\n    this.y *= scalar;\n  }\n\n  div(scalar) {\n    this.x /= scalar;\n    this.y /= scalar;\n  }\n\n  mag() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  normalize() {\n    const m = this.mag();\n    this.div(m);\n  }\n\n  rotateAroundVector(vector, angle, inRadians) {\n    if (inRadians) {\n        angle = angle * (180 / Math.PI);\n    }\n\n    let { x, y } = this;\n\n    x -= vector.x;\n    y -= vector.y\n\n    this.x = x * Math.cos(angle) - y * Math.sin(angle);\n    this.y = y * Math.cos(angle) + x * Math.sin(angle);\n\n    this.x += vector.x;\n    this.y += vector.y;\n  }\n\n  static magnitude(v1, v2) {\n    return Math.sqrt(\n      Math.pow(v1.x - v2.x, 2) + Math.pow(v1.y - v2.y, 2)\n    );\n  }\n\n  static findAngle(v0, v1, v2) {\n    let a = Math.pow(v1.x - v0.x, 2) + Math.pow(v1.y - v0.y, 2);\n    let b = Math.pow(v1.x - v2.x, 2) + Math.pow(v1.y - v2.y, 2);\n    let c = Math.pow(v2.x - v0.x, 2) + Math.pow(v2.y - v0.y, 2);\n\n    let delta = (a + b - c) / Math.sqrt(4 * a * b);\n    let angle = Math.acos(delta);\n\n    if (delta < -1) {\n      return Math.PI;\n    } else if (delta > 1) {\n      return 0;\n    }\n\n    if (v0.y > v1.y) {\n      angle = 2 * Math.PI - angle;\n    }\n\n    return angle;\n  }\n}\n","import Vector2d from './vector2d';\n\nconst restartKeyState = key => {\n    key.isPressed = false;\n    key.wasPressed = false;\n    key.isDown = false;\n};\n\nexport const InputManager = {\n    _canvas: null,\n    keys: {},\n    mouseState: {\n        pos: new Vector2d(0, 0),\n        posInCanvas: new Vector2d(0, 0),\n        prevPos: new Vector2d(0, 0),\n        mouse1: false,\n        mouse2: false\n    },\n    init (canvasSelector) {\n        this._canvas = document.querySelector(canvasSelector);\n\n        this._initKeyBoardEvents();\n        this._initMouseEvents();\n\n        for(let i = 0; i < 255; i++) {\n            this.keys[i] = {\n                isPressed: false,\n                wasPressed: false,\n                isDown: false,\n            }\n        }\n    },\n    update() {\n        Object.keys(this.keys).forEach(keyCode => {\n            if (this.keys[keyCode].wasPressed) {\n                this.keys[keyCode].isDown = true;\n                this.keys[keyCode].isPressed = false;\n            }\n\n            if (!this.keys[keyCode].isDown) {\n                this.keys[keyCode].wasPressed = this.keys[keyCode].isPressed;\n            }\n        });\n    },\n    _initKeyBoardEvents () {\n        window.addEventListener('keydown', (e) => {\n            if (!this.keys[e.keyCode]) {\n                this.keys[e.keyCode] = {\n                    isPressed: true,\n                    wasPressed: false,\n                    isDown: false\n                };\n\n                return;\n            } else {\n                this.keys[e.keyCode].isDown = true;\n            }\n\n            if (!this.keys[e.keyCode].isDown) {\n                this.keys[e.keyCode].isPressed = true;\n            }\n        });\n\n        window.addEventListener('keyup', (e) => {\n            restartKeyState(this.keys[e.keyCode]);\n        });\n    },\n    _initMouseEvents () {\n        window.addEventListener('mousemove', (e) => {\n            const boundingRect = this._canvas.getBoundingClientRect();\n\n            const pos = new Vector2d(Math.floor(e.clientX), Math.floor(e.clientY));\n            const posInCanvas = new Vector2d(pos.x - Math.floor(boundingRect.x), pos.y - Math.floor(boundingRect.y));\n\n            this.mouseState.prevPos = this.mouseState.pos;\n\n            this.mouseState.pos = pos;\n            this.mouseState.posInCanvas = posInCanvas;\n        });\n\n        // #TODO: finish after getting normal mouse\n        window.addEventListener('mousedown', (e) => {\n            if (e.button === 0) {\n                this.mouseState.mouse1 = true;\n            }\n\n            if (e.button === 2) {\n                this.mouseState.mouse2 = true;\n            }\n        });\n\n        window.addEventListener('mouseup', (e) => {\n            if (e.button === 0) {\n                this.mouseState.mouse1 = false;\n            }\n\n            if (e.button === 2) {\n                this.mouseState.mouse2 = false;\n            }\n        });\n    }\n}\n","export const getImageDataFromImage = image => {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  canvas.width = image.width;\n  canvas.height = image.height;\n\n  ctx.imageSmoothingEnabled = false;\n  ctx.drawImage(image, 0, 0);\n  return ctx.getImageData(0, 0, image.width, image.height);\n}\n\nexport const copyPixel = (sourceImageData, sx, sy, ssize, destImageData, dx, dy, dsize, alpha) => {\n  const sourceIndex = ((Math.floor(sy) * ssize) + Math.floor(sx)) * 4;\n  const destIndex = ((Math.floor(dy) * dsize) + Math.floor(dx)) * 4;\n\n  addPixelToImageData(sourceImageData, sourceIndex, destImageData, destIndex, alpha);\n}\n\nfunction addPixelToImageData(sourceData, sourceIndex, dest, destIndex, alpha) {\n  if(!sourceData.data[sourceIndex + 3]) { return; }\n\n  dest.data[destIndex] = sourceData.data[sourceIndex];\n  dest.data[destIndex + 1] = sourceData.data[sourceIndex + 1];\n  dest.data[destIndex + 2] = sourceData.data[sourceIndex + 2];\n  dest.data[destIndex + 3] = sourceData.data[sourceIndex + 3];\n\n  if (alpha) {\n    dest.data[destIndex + 3] = alpha;\n    return;\n  }\n}\n\nexport default {\n  copyPixel,\n  getImageDataFromImage\n}\n","export const resolutionWidth = 800;\nexport const resolutionHeight = 600;\nexport const playerMovementSpeed = 0.1;\nexport const viewSkipDistance = 14;\nexport const viewDistance = 14;\nexport const viewDistanceObjectFix = 1.5;\nexport const viewDistanceWallFix = 1.5;\nexport const cameraMinY = -300;\nexport const cameraMaxY = 200;\n","import Vector2d from './vector2d';\n\nimport { copyPixel } from './imageData.helper';\nimport { \n  resolutionWidth, \n  resolutionHeight,\n  viewDistance,\n  viewDistanceWallFix,\n  viewDistanceObjectFix,\n} from './config';\n\n/*\n  TODO:\n  1. Fix performance on floor and celing, \n     max number of iterations should be \n     resolutionWidth * resolutionHeight \n     but it's goes above this number,\n*/\n\nconst textureSize = 16;\n\nconst mapValue = (input, a, b, c, d) => {\n  return c + ((d - c) / (b - a)) * (input - a);\n};\n\nexport default class RaycastRenderer {\n  constructor(ctx) {\n    this.ctx = ctx;\n    this.rayCastingImageData = new ImageData(resolutionWidth, resolutionHeight);\n    this.camera = {\n      planeX: 0.62,\n      planeY: 0.66,\n      lookY: 0,\n      pointingAt: '',\n    };\n  }\n\n  getCamera() {\n    return this.camera;\n  }\n\n  castRays(playerPosition, rayDir, walls) {\n    const hitWalls = [];\n\n    for (let i = 0; i < walls.length; i++) {\n      const { v1, v2, height, texture } = walls[i];\n\n      const x1 = v1.x;\n      const y1 = v1.y;\n      const x2 = v2.x;\n      const y2 = v2.y;\n\n      const x3 = playerPosition.x;\n      const y3 = playerPosition.y;\n\n      const x4 = playerPosition.x + rayDir.x;\n      const y4 = playerPosition.y + rayDir.y;\n\n      const den = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\n      if (den === 0) { \n        continue;\n      }\n\n      const t = ((x1 - x3) * (y3 - y4) - (y1 - y3) * (x3 - x4)) / den;\n      const u = - ((x1 - x2) * (y1 - y3) - (y1 - y2) * (x1 - x3)) / den;\n\n      if (t <= 0 || t >= 1 || u <= 0) {\n        continue;\n      }\n\n      const mapPos = new Vector2d(x1 + t * (x2 - x1), y1 + t * (y2 - y1));\n      const len = Vector2d.magnitude(mapPos, playerPosition);\n\n      hitWalls.push({\n        id: 4,\n        side: 0,\n        len,\n        mapPos,\n        height,\n        texture,\n        type: 'WALL',\n      });\n    }\n\n    return [hitWalls];\n  }\n\n  prepareObjectToDraw(player, objects) {\n    const { position, dir } = player;\n    const { planeX, planeY, lookY } = this.camera;\n\n    const sortedObjects = [];\n\n    const texWidth = 16;\n    const texHeight = 16;\n\n    objects.sort((obj1, obj2) => {\n      const len = Vector2d.magnitude(obj1.pos, position);\n      const len2 = Vector2d.magnitude(obj2.pos, position);\n\n      return len2 - len;\n    }).forEach(obj => {\n      const { uDiv = 1, vDiv = 1, vMove = 0 } = obj;\n\n      const spriteX = obj.pos.x - position.x;\n      const spriteY = obj.pos.y - position.y;\n\n      const invDet = 1 / (planeX * dir.y - dir.x * planeY);\n      const transformX = invDet * (dir.y * spriteX - dir.x * spriteY);\n      const transformY = invDet * (- planeY * spriteX + planeX * spriteY);\n\n      const len = Vector2d.magnitude(obj.pos, position);\n\n      const spriteScreenX = Math.floor((resolutionWidth / 2) * (1 + transformX / transformY));\n\n      const vMoveScreen = Math.floor(vMove / transformY) + lookY;\n\n      const spriteHeight = Math.abs(Math.floor(resolutionHeight / transformY)) / vDiv;\n\n      let drawStartY = -spriteHeight / 2 + resolutionHeight / 2 + vMoveScreen;\n      if (drawStartY < 0 - lookY) drawStartY = 0;\n      let drawEndY = spriteHeight / 2 + resolutionHeight / 2 + vMoveScreen;\n      if (drawEndY >= resolutionHeight - lookY) drawEndY = resolutionHeight - 1;\n\n      const spriteWidth = Math.abs(Math.floor(resolutionHeight / transformY)) / uDiv;\n      let drawStartX = -spriteWidth / 2 + spriteScreenX;\n      if (drawStartX < 0) drawStartX = 0;\n      let drawEndX = spriteWidth / 2 + spriteScreenX;\n      if (drawEndX >= resolutionWidth) drawEndX = resolutionHeight - 1;\n\n      sortedObjects.push({\n        drawStartX: Math.floor(drawStartX),\n        drawEndX: Math.floor(drawEndX),\n        drawStartY,\n        drawEndY,\n        vMoveScreen,\n        obj,\n        len,\n        spriteScreenX, \n        spriteWidth,\n        spriteHeight,\n        transformY,\n        texWidth,\n        texHeight,\n        type: 'OBJECT',\n      });\n\n    });\n\n    return sortedObjects;\n  }\n\n  drawFloor(player, element, ray, x) {\n    const { mapPos } = element;\n    const { position } = player;\n    const { perpWallDist, drawStart } = ray;\n\n    for (let y = drawStart; y < resolutionHeight - this.camera.lookY; y++) {\n      const currentDist = resolutionHeight / (2 * y - resolutionHeight);\n\n      const weight = currentDist / perpWallDist;\n\n      const currentFloorX = (weight * mapPos.x + (1 - weight) * position.x);\n      const currentFloorY = (weight * mapPos.y + (1 - weight) * position.y);\n\n      const floorTexX = ~~(currentFloorX * textureSize) % textureSize;\n      const floorTexY = ~~(currentFloorY * textureSize) % textureSize;\n\n      const alpha = mapValue(currentDist, 0, viewDistance, 255, 0);\n\n      copyPixel(window.floorImageData, floorTexX, floorTexY, textureSize, this.rayCastingImageData, x, y + this.camera.lookY, resolutionWidth, alpha);\n    }\n  }\n\n  drawCeling(player, element, ray, x) {\n    const { mapPos } = element;\n    const { position } = player;\n    const { perpWallDist, drawEnd } = ray;\n\n    if (drawEnd < 0) {\n      return;\n    }\n\n    for (let y = 0 - this.camera.lookY; y < drawEnd; y++) {\n      const currentDist = resolutionHeight / (resolutionHeight - 2 * y);\n      const weight = currentDist / perpWallDist;\n\n      const currentFloorX = (weight * mapPos.x + (1 - weight) * position.x);\n      const currentFloorY = (weight * mapPos.y + (1 - weight) * position.y);\n\n      const floorTexX = ~~(currentFloorX * textureSize) % textureSize;\n      const floorTexY = ~~(currentFloorY * textureSize) % textureSize;\n\n      const alpha = mapValue(currentDist, 0, viewDistance, 255, 0);\n\n      copyPixel(window.celingImageData, floorTexX, floorTexY, textureSize, this.rayCastingImageData, x, y + this.camera.lookY, resolutionWidth, alpha);\n    }\n  }\n\n\n  drawObject(object, x) {\n    const {\n      drawStartY,\n      drawEndY,\n      vMoveScreen,\n      spriteScreenX, \n      spriteWidth,\n      spriteHeight,\n      transformY,\n      texWidth,\n      texHeight,\n      obj,\n      len,\n    } = object;\n\n    const alpha = mapValue(len, 0, viewDistance * viewDistanceObjectFix, 254, 0);\n\n    const texX = Math.floor(256 * (x - (-spriteWidth / 2 + spriteScreenX)) * texWidth / spriteWidth) / 256;\n    if (transformY > 0) {\n      for(let y = Math.floor(drawStartY); y < drawEndY; y++) {\n        if (x === resolutionWidth / 2 && y === resolutionHeight / 2) {\n          this.camera.pointingAt = obj.type;  \n        }\n        const d = (y - vMoveScreen) * 256 - resolutionHeight * 128 + spriteHeight * 128;\n        const texY = ((d * texHeight) / spriteHeight) / 256;\n\n        copyPixel(obj.texture, texX, texY, textureSize, this.rayCastingImageData, x, y, resolutionWidth, alpha);\n      }\n    }\n  }\n\n  drawWall(player, wall, x, rayDir, isClosestWall) {\n    const { position } = player;\n\n    const ray = {};\n    ray.dir = rayDir;\n\n    let { mapPos, texture } = wall;\n\n    ray.perpWallDist = (mapPos.x - position.x) / ray.dir.x;\n\n    let lineHeight = Math.floor(Math.abs(resolutionHeight / ray.perpWallDist));\n\n    ray.drawStart = (resolutionHeight + lineHeight) / 2;\n    ray.drawEnd = ray.drawStart - lineHeight;\n\n    let wallX = position.y + ray.perpWallDist * ray.dir.y;\n    wallX += position.x + ray.perpWallDist * ray.dir.x;\n    wallX -= Math.floor(wallX);\n\n    const textureX = Math.floor((wallX - Math.floor(wallX)) * textureSize);\n\n    let offsetDS = 0;\n    if (ray.drawStart > resolutionHeight) {\n      offsetDS = ray.drawStart;\n      ray.drawStart = resolutionHeight;\n    }\n\n    let offsetDE = 0;\n    if (ray.drawEnd < 0) {\n      offsetDE = ray.drawEnd;\n      ray.drawEnd = 0;\n    }\n\n    lineHeight = ray.drawStart - ray.drawEnd;\n    lineHeight;\n\n    let mapValueMin = offsetDE ? offsetDE : 0;\n    let mapValueMax = offsetDS ? offsetDS : lineHeight;\n\n    const alpha = mapValue(Vector2d.magnitude(position, mapPos), 0, viewDistance * viewDistanceWallFix, 255, 0);\n\n    for (let i = this.camera.lookY < 0 ? this.camera.lookY : 0; i < lineHeight + (this.camera.lookY > 0 ? this.camera.lookY : 0); i++) {\n      const textureY = Math.floor(\n        mapValue(i,\n          mapValueMin,\n          mapValueMax,\n          0,\n          textureSize\n        )\n      );\n\n      copyPixel(texture, textureX, textureY, textureSize, this.rayCastingImageData, Math.floor(x), Math.floor(ray.drawStart - i + this.camera.lookY), resolutionWidth, alpha);\n    }\n\n    if (isClosestWall) {\n      this.drawFloor(player, wall, ray, x);\n      this.drawCeling(player, wall, ray, x);\n    }\n  }\n\n  draw(player, walls, objects) {\n    const { position, dir } = player;\n\n    for (let x = 0; x < resolutionWidth; x++) {\n      const cameraX = 2 * x / resolutionWidth - 1; \n      const rayDir = new Vector2d(dir.x + this.camera.planeX * cameraX, dir.y + this.camera.planeY * cameraX);\n\n      const [hitWalls] = this.castRays(position, rayDir, walls);\n      const visibleObjects = objects.filter(({ drawStartX, drawEndX }) => {\n        return drawStartX < x && x < drawEndX; \n      });\n\n      const elementsToDraw = [...hitWalls, ...visibleObjects].sort((elem1, elem2) => elem2.len - elem1.len);\n\n      let lastElementIndex = 0;\n      for (let i = elementsToDraw.length - 1; i > 0; i--) {\n        if (elementsToDraw[i].type === 'WALL') {\n          lastElementIndex = i;\n          break;\n        }\n      }\n\n      elementsToDraw.forEach((element, index) => {\n        if (element.type === 'WALL') {\n          this.drawWall(player, element, x, rayDir, lastElementIndex === index);\n          return;\n        }\n\n        if (element.type === 'OBJECT') {\n          this.drawObject(element, x);\n          return;\n        }\n      });\n    }\n  }\n\n  update(player, objects, walls) {\n    this.camera.pointingAt = 'WORLD';\n    this.rayCastingImageData = new ImageData(resolutionWidth, resolutionHeight);\n    this.ctx.clearRect(0, 0, 800, 400);\n    const preparedObjects = this.prepareObjectToDraw(player, objects);\n    this.draw(player, walls, preparedObjects);\n\n    this.ctx.putImageData(this.rayCastingImageData, 0, 0);\n    this.ctx.fillStyle = 'red';\n    this.ctx.fillRect(\n      resolutionWidth / 2 - 2,\n      resolutionHeight / 2 - 2,\n      2,\n      2,\n    );\n  }\n}\n\n","import Vector2d from './vector2d';\nimport {InputManager} from './inputManager';\n\nimport {getImageDataFromImage} from './imageData.helper';\nimport {playerMovementSpeed, cameraMinY, cameraMaxY} from './config';\nimport RaycastRenderer from './raycastRenderer';\n\nconst pointingAtSpan = document.querySelector('#pointing-at');\n\nconst player = {\n  position: new Vector2d(20, 20),\n  dir: new Vector2d(1, -1),\n  pointing: 'nothing',\n};\n\nconst walls = [\n  {\n    v1: new Vector2d(30, 0),\n    v2: new Vector2d(30, 30),\n  },\n  {\n    v1: new Vector2d(30, 30),\n    v2: new Vector2d(0, 30),\n  },\n  {\n    v1: new Vector2d(20, 20),\n    v2: new Vector2d(0, 20),\n  },\n\n  {\n    v1: new Vector2d(10, 10),\n    v2: new Vector2d(0, 10),\n  },\n  {\n    v1: new Vector2d(0, 30),\n    v2: new Vector2d(0, 0),\n  },\n  {\n    v1: new Vector2d(0, 0),\n    v2: new Vector2d(30, 0),\n  },\n];\n\nconst objects = [\n  {\n    id: 0,\n    pos: new Vector2d(15, 15),\n    type: 'AMMO',\n    vMove: -160,\n    uDiv: 4,\n    vDiv: 4\n  },\n  {\n    id: 1,\n    pos: new Vector2d(25, 17),\n    type: 'AMMO',\n    vMove: 160,\n    uDiv: 4,\n    vDiv: 4\n  },\n  {\n    id: 2,\n    pos: new Vector2d(5, 15),\n    type: 'AMMO',\n    vMove: 0,\n    uDiv: 4,\n    vDiv: 4\n  },\n];\n\nconst canvas = document.querySelector('#game-canvas');\nconst ctx = canvas.getContext('2d');\nctx.webkitImageSmoothingEnabled = false;\nctx.mozImageSmoothingEnabled = false;\nctx.imageSmoothingEnabled = false;\n\nconst raycastRenderer = new RaycastRenderer(ctx);\nconst camera = raycastRenderer.getCamera();\n\nconst mouseMove = e => {\n  if (\n    e.movementY > 0 && camera.lookY > cameraMinY ||\n    e.movementY < 0 && camera.lookY < cameraMaxY\n  ) {\n    camera.lookY -= e.movementY;\n  }\n\n  const rotSpeed = e.movementX / 1000;\n\n  const oldDirX = player.dir.x;\n  player.dir.x = player.dir.x * Math.cos(rotSpeed) - player.dir.y * Math.sin(rotSpeed);\n  player.dir.y = oldDirX * Math.sin(rotSpeed) + player.dir.y * Math.cos(rotSpeed);\n\n  const oldPlaneX = camera.planeX;\n  camera.planeX = camera.planeX * Math.cos(rotSpeed) - camera.planeY * Math.sin(rotSpeed);\n  camera.planeY = oldPlaneX * Math.sin(rotSpeed) + camera.planeY * Math.cos(rotSpeed);\n}\n\nlet pointerlockvalue = false;\ndocument.addEventListener('pointerlockchange', () => {\n  pointerlockvalue = !pointerlockvalue;\n\n  if (pointerlockvalue) {\n    canvas.addEventListener('mousemove', mouseMove);\n  } else {\n    canvas.removeEventListener('mousemove', mouseMove);\n  }\n});\n\ncanvas.addEventListener('mousedown', () => {\n  canvas.requestPointerLock();\n})\n\nInputManager.init('#game-canvas');\n\nconst playerMovement = () => {\n  if (InputManager.keys[87] && InputManager.keys[87].isDown) {\n    player.position.y += player.dir.y * playerMovementSpeed;\n    player.position.x += player.dir.x * playerMovementSpeed;\n  }\n\n  if (InputManager.keys[83] && InputManager.keys[83].isDown) {\n    player.position.y -= player.dir.y * playerMovementSpeed;\n    player.position.x -= player.dir.x * playerMovementSpeed;\n  }\n\n};\n\nconst loop = () => {\n  playerMovement();\n  raycastRenderer.update(player, objects, walls);\n  pointingAtSpan.innerHTML = `${raycastRenderer.getCamera().pointingAt}`;\n  window.requestAnimationFrame(loop);\n};\n\nconst loadAsset = src => {\n  console.log(src);\n  return new Promise(resolve => {\n    console.log('test123')\n    const asset = new Image();\n    asset.src = src;\n    asset.onload = () => {\n      resolve(asset);\n    }\n\n    asset.onerror = (err) => {\n      console.log(err);\n    }\n  });\n};\n\nconsole.log(\"test\")\n\nloadAsset('./Wall.png').then(asset => {\n  console.log(\"test123\");\n  const wallImageData = getImageDataFromImage(asset);\n  walls.forEach(wall => wall.texture = wallImageData);\n  return loadAsset('Floor.png')\n}).then(asset => {\n  window.floorImageData = getImageDataFromImage(asset);\n  return loadAsset('Celling.png')\n}).then(asset => {\n  window.celingImageData = getImageDataFromImage(asset);\n  return loadAsset('Ammo.png')\n}).then(asset => {\n  const ammoImageData = getImageDataFromImage(asset);\n  objects.forEach(object => {object.texture = ammoImageData})\n  window.requestAnimationFrame(loop);\n});\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}