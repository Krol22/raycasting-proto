{"version":3,"sources":["map.js","cgtutor.js"],"names":["map","console","log","MAP_WIDTH","MAP_HEIGHT","ctx","document","querySelector","getContext","posX","posY","dirX","dirY","planeX","planeY","time","oldTime","cameraX","rayDirX","rayDirY","w","h","update","x","mapX","Math","floor","mapY","sideDistX","sideDistY","deltaDistX","abs","deltaDistY","prepWallDist","stepX","stepY","hit","side","lineHeight","drawStart","drawEnd","color","save","translate","moveTo","fillStyle","fillRect","restore","loop","window","requestAnimationFrame","rotSpeed","addEventListener","e","key","oldDirX","cos","sin","oldPlaneX"],"mappings":"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","file":"cgtutor.521770f5.js","sourceRoot":"..","sourcesContent":["export const map = [\n  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\n];\n","import { map } from './map';\nconsole.log(map);\n\nconst MAP_WIDTH = 24;\nconst MAP_HEIGHT = 24;\n\nconst ctx = document.querySelector('#game-canvas').getContext('2d');\n\nlet posX = 22;\nlet posY = 12;\nlet dirX = -1;\nlet dirY = 0;\n\nlet planeX = 0;\nlet planeY = 0.66;\n\nlet time = 0;\nlet oldTime = 0;\n\nlet cameraX, rayDirX, rayDirY;\n\nlet w = 800;\nlet h = 400;\n\nconst update = () => {\n  // cast 'RAYS';\n  for (let x = 0; x < w; x++) {\n    cameraX = 2 * x / w - 1; \n\n    // get ray direction\n    rayDirX = dirX + planeX * cameraX;\n    rayDirY = dirY + planeY * cameraX;\n\n    // -------- DDA ---------\n\n    // get player coords;\n    const mapX = Math.floor(posX);\n    const mapY = Math.floor(posY);\n\n    // length of ray from current position to next x or y-side\n    let sideDistX, sideDistY;\n\n    // length of ray from one x or y-side to next x or y-side\n    let deltaDistX = Math.abs(1 / rayDirX);\n    let deltaDistY = Math.abs(1 / rayDirY);\n    let prepWallDist;\n\n    // direction of step\n    let stepX;\n    let stepY;\n\n    let hit = false;\n    let side; // 0 if x-axis side was hit 1 when y-axis side was hit\n\n    // calculate step & initial sideDist,\n\n    if (rayDirX < 0) {\n      stepX = -1;\n      sideDistX = (posX - mapX) * deltaDistX;\n    } else {\n      stepX = 1;\n      sideDistX = (mapX + 1.0 - posX) * deltaDistX;\n    }\n    if (rayDirY < 0) {\n      stepY = -1;\n      sideDistY = (posY - mapY) * deltaDistY;\n    } else {\n      stepY = 1;\n      sideDistY = (mapY + 1.0 - posY) * deltaDistY;\n    } \n\n    // Actual DDA\n    while (!hit) {\n      if (sideDistX < sideDistY) {\n        sideDistX += deltaDistX;\n        mapX += stepX;\n        side = 0;\n      } else {\n        sideDistY += deltaDistY;\n        mapY += stepY;\n        side = 1;\n      }\n\n      if (map[mapX][mapY] > 0) {\n        hit = true;\n      }\n    }\n\n    // ------- DDA DONE -------\n\n    // Calculate distance projected on camera\n    if (side === 0) {\n      prepWallDist = (mapX - posX + (1 - stepX) / 2) / rayDirX;\n    } else {\n      prepWallDist = (mapY - posY + (1 - stepY) / 2) / rayDirY;\n    }\n\n    // Calculate col height;\n    let lineHeight = h / prepWallDist;\n\n    // calculate lowest and highest pixel;\n    let drawStart = -lineHeight / 2 + h / 2;\n    if (drawStart < 0) drawStart = 0;\n\n    let drawEnd = lineHeight / 2 + h / 2;\n    if (drawEnd >= h) drawEnd = h - 1;\n\n    let color;\n    switch(map[mapX][mapY]) {\n      case(1): {\n        color= 'red';\n        break;\n      }\n      case(2): {\n        color= 'green';\n        break;\n      }\n      case(3): {\n        color= 'blue';\n        break;\n      }\n      case(4): {\n        color= 'white';\n        break;\n      }\n      default: {\n        color= 'yellow';\n      }\n    }\n\n    if (side === 1) {\n      color = 'gray';\n    }\n\n    ctx.save();\n    ctx.translate(x * 1, drawStart);\n    ctx.moveTo(0, 0);\n    ctx.fillStyle = color;\n    ctx.fillRect(0, -drawStart / 2, 1, drawEnd);\n    ctx.restore();\n  }\n};\n\nconst loop = () => {\n  ctx.fillStyle = 'black';\n  ctx.fillRect(0, 0, 800, 400);\n  update(); \n  window.requestAnimationFrame(loop);\n};\n\nconst rotSpeed = 0.1;\n\nwindow.addEventListener('keydown', e => {\n  if (e.key === 'ArrowUp') {\n    posY += dirY * 0.5;\n  }\n  if (e.key === 'ArrowDown') {\n    posY -= dirY * 0.5;\n  }\n  if (e.key === 'ArrowRight') {\n    posX += dirX * 0.5;\n  }\n  if (e.key === 'ArrowLeft') {\n    posX -= dirX * 0.5;\n  }\n\n  if (e.key === 'd') {\n    const oldDirX = dirX;\n    dirX = dirX * Math.cos(-rotSpeed) - dirY * Math.sin(-rotSpeed);\n    dirY = oldDirX * Math.sin(-rotSpeed) + dirY * Math.cos(-rotSpeed);\n\n    const oldPlaneX = planeX;\n    planeX = planeX * Math.cos(-rotSpeed) - planeY * Math.sin(-rotSpeed);\n    planeY = oldPlaneX * Math.sin(-rotSpeed) + planeY * Math.cos(-rotSpeed);\n  }\n  \n  if (e.key === 'a') {\n    const oldDirX = dirX;\n    dirX = dirX * Math.cos(rotSpeed) - dirY * Math.sin(rotSpeed);\n    dirY = oldDirX * Math.sin(rotSpeed) + dirY * Math.cos(rotSpeed);\n\n    const oldPlaneX = planeX;\n    planeX = planeX * Math.cos(rotSpeed) - planeY * Math.sin(rotSpeed);\n    planeY = oldPlaneX * Math.sin(rotSpeed) + planeY * Math.cos(rotSpeed);\n\n  }\n});\n\nwindow.requestAnimationFrame(loop);\n"]}