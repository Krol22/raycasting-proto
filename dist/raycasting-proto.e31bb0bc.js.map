{"version":3,"sources":["map.js","index.js"],"names":["map","MAP_ROWS","MAP_COLS","canvas","document","querySelector","ctx","getContext","strokeStyle","mouseX","mouseY","window","addEventListener","e","x","y","Particle","posX","posY","rays","i","Math","PI","push","Ray","save","beginPath","translate","arc","stroke","restore","walls","forEach","ray","closest","record","Infinity","wall","pt","cast","d","sqrt","pow","moveTo","lineTo","Boundary","x1","y1","x2","y2","lineWidth","angle","dirX","sin","dirY","cos","len","x3","y3","x4","y4","den","t","u","wall2","wall3","particle","update","clearRect","fillStyle","fillRect","draw","look","loop","requestAnimationFrame"],"mappings":";;ACAA;;;;ADAO,IAAMA,GAAG,GAAG,CACjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CADiB,EAEjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAFiB,EAGjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAHiB,EAIjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAJiB,EAKjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CALiB,EAMjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CANiB,EAOjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAPiB,EAQjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CARiB,EASjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CATiB,EAUjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAViB,EAWjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAXiB,EAYjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAZiB,EAajB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAbiB,EAcjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAdiB,EAejB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAfiB,EAgBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAhBiB,EAiBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAjBiB,EAkBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAlBiB,EAmBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAnBiB,EAoBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CApBiB,EAqBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CArBiB,EAsBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAtBiB,EAuBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAvBiB,EAwBjB,CAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,EAAS,CAAT,EAAW,CAAX,EAAa,CAAb,EAAe,CAAf,EAAiB,CAAjB,EAAmB,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,EAAyB,CAAzB,EAA2B,CAA3B,EAA6B,CAA7B,EAA+B,CAA/B,EAAiC,CAAjC,EAAmC,CAAnC,EAAqC,CAArC,EAAuC,CAAvC,EAAyC,CAAzC,EAA2C,CAA3C,EAA6C,CAA7C,EAA+C,CAA/C,CAxBiB,CAAZ;;;;ACEP,IAAMC,QAAQ,GAAG,EAAjB;AACA,IAAMC,QAAQ,GAAG,EAAjB;AAEA,IAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,cAAvB,CAAf;AACA,IAAMC,GAAG,GAAGH,MAAM,CAACI,UAAP,CAAkB,IAAlB,CAAZ;AACAD,GAAG,CAACE,WAAJ,GAAkB,OAAlB;AAEA,IAAIC,MAAM,GAAG,CAAb;AACA,IAAIC,MAAM,GAAG,CAAb;AAEAC,MAAM,CAACC,gBAAP,CAAwB,WAAxB,EAAqC,UAAAC,CAAC,EAAI;AACxCJ,EAAAA,MAAM,GAAGI,CAAC,CAACC,CAAX;AACAJ,EAAAA,MAAM,GAAGG,CAAC,CAACE,CAAX;AACD,CAHD;;IAKMC;;;AACJ,sBAAc;AAAA;;AACZ,SAAKC,IAAL,GAAY,GAAZ;AACA,SAAKC,IAAL,GAAY,GAAZ;AACA,SAAKC,IAAL,GAAY,EAAZ;;AACA,SAAK,IAAIC,CAAC,GAAG,CAACC,IAAI,CAACC,EAAnB,EAAuBF,CAAC,GAAGC,IAAI,CAACC,EAAhC,EAAoCF,CAAC,IAAEC,IAAI,CAACC,EAAL,GAAU,GAAjD,EAAsD;AACpD,WAAKH,IAAL,CAAUI,IAAV,CAAe,IAAIC,GAAJ,CAAQ,KAAKP,IAAb,EAAmB,KAAKC,IAAxB,EAA8BE,CAA9B,CAAf;AACD;AACF;;;;2BAEM;AACLd,MAAAA,GAAG,CAACmB,IAAJ;AACAnB,MAAAA,GAAG,CAACoB,SAAJ;AACApB,MAAAA,GAAG,CAACqB,SAAJ,CAAc,KAAKV,IAAnB,EAAyB,KAAKC,IAA9B;AACAZ,MAAAA,GAAG,CAACsB,GAAJ,CAAQ,CAAR,EAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoB,IAAIP,IAAI,CAACC,EAA7B;AACAhB,MAAAA,GAAG,CAACuB,MAAJ;AACAvB,MAAAA,GAAG,CAACwB,OAAJ,GANK,CAOL;AACE;AACF;AACD;;;6BAEQ;AACP,WAAKb,IAAL,GAAYR,MAAZ;AACA,WAAKS,IAAL,GAAYR,MAAZ;AACA,WAAKS,IAAL,GAAY,EAAZ;;AACA,WAAK,IAAIC,CAAC,GAAG,CAACC,IAAI,CAACC,EAAnB,EAAuBF,CAAC,GAAGC,IAAI,CAACC,EAAhC,EAAoCF,CAAC,IAAIC,IAAI,CAACC,EAAL,GAAU,GAAnD,EAAwD;AACtD,aAAKH,IAAL,CAAUI,IAAV,CAAe,IAAIC,GAAJ,CAAQ,KAAKP,IAAb,EAAmB,KAAKC,IAAxB,EAA8BE,CAA9B,CAAf;AACD;AACF;;;yBAEIW,OAAO;AAAA;;AACV,WAAKZ,IAAL,CAAUa,OAAV,CAAkB,UAAAC,GAAG,EAAI;AACvB,YAAIC,OAAO,GAAG,IAAd;AACA,YAAIC,MAAM,GAAGC,QAAb;AACAL,QAAAA,KAAK,CAACC,OAAN,CAAc,UAAAK,IAAI,EAAI;AACpB,cAAMC,EAAE,GAAGL,GAAG,CAACM,IAAJ,CAASF,IAAT,CAAX;;AACA,cAAIC,EAAJ,EAAQ;AACN,gBAAME,CAAC,GAAGnB,IAAI,CAACoB,IAAL,CAAUpB,IAAI,CAACqB,GAAL,CAAS,KAAI,CAACzB,IAAL,GAAYqB,EAAE,CAACxB,CAAxB,EAA2B,CAA3B,IAAgCO,IAAI,CAACqB,GAAL,CAAS,KAAI,CAACxB,IAAL,GAAYoB,EAAE,CAACvB,CAAxB,EAA2B,CAA3B,CAA1C,CAAV;;AACA,gBAAIyB,CAAC,GAAGL,MAAR,EAAgB;AACdA,cAAAA,MAAM,GAAGK,CAAT;AACAN,cAAAA,OAAO,GAAGI,EAAV;AACD;AAEF;AACF,SAVD;;AAYA,YAAIJ,OAAJ,EAAa;AACX5B,UAAAA,GAAG,CAACmB,IAAJ;AACAnB,UAAAA,GAAG,CAACoB,SAAJ;AACApB,UAAAA,GAAG,CAACqB,SAAJ,CAAc,KAAI,CAACV,IAAnB,EAAyB,KAAI,CAACC,IAA9B;AACAZ,UAAAA,GAAG,CAACqC,MAAJ,CAAW,CAAX,EAAc,CAAd;AACArC,UAAAA,GAAG,CAACsC,MAAJ,CAAWV,OAAO,CAACpB,CAAR,GAAY,KAAI,CAACG,IAA5B,EAAkCiB,OAAO,CAACnB,CAAR,GAAY,KAAI,CAACG,IAAnD;AACAZ,UAAAA,GAAG,CAACuB,MAAJ;AACAvB,UAAAA,GAAG,CAACwB,OAAJ;AACD;AACF,OAxBD;AAyBD;;;;;;IAGGe;;;AACJ,oBAAYC,EAAZ,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwBC,EAAxB,EAA4B;AAAA;;AAC1B,SAAKH,EAAL,GAAUA,EAAV;AACA,SAAKC,EAAL,GAAUA,EAAV;AACA,SAAKC,EAAL,GAAUA,EAAV;AACA,SAAKC,EAAL,GAAUA,EAAV;AACD;;;;2BACM;AACL3C,MAAAA,GAAG,CAACmB,IAAJ;AACAnB,MAAAA,GAAG,CAACoB,SAAJ;AACApB,MAAAA,GAAG,CAAC4C,SAAJ,GAAgB,GAAhB;AACA5C,MAAAA,GAAG,CAACqB,SAAJ,CAAc,KAAKmB,EAAnB,EAAuB,KAAKC,EAA5B;AACAzC,MAAAA,GAAG,CAACqC,MAAJ,CAAW,CAAX,EAAc,CAAd;AACArC,MAAAA,GAAG,CAACsC,MAAJ,CAAW,KAAKI,EAAL,GAAU,KAAKF,EAA1B,EAA8B,KAAKG,EAAL,GAAU,KAAKF,EAA7C;AACAzC,MAAAA,GAAG,CAACuB,MAAJ;AACAvB,MAAAA,GAAG,CAACwB,OAAJ;AACD;;;;;;IAGGN;;;AACJ,eAAYV,CAAZ,EAAeC,CAAf,EAAkBoC,KAAlB,EAAyB;AAAA;;AACvB,SAAKlC,IAAL,GAAYH,CAAZ;AACA,SAAKI,IAAL,GAAYH,CAAZ;AACA,SAAKqC,IAAL,GAAY/B,IAAI,CAACgC,GAAL,CAASF,KAAT,CAAZ;AACA,SAAKG,IAAL,GAAYjC,IAAI,CAACkC,GAAL,CAASJ,KAAT,CAAZ;AACD;;;;2BAEM;AACL7C,MAAAA,GAAG,CAACmB,IAAJ;AACAnB,MAAAA,GAAG,CAACoB,SAAJ;AACApB,MAAAA,GAAG,CAAC4C,SAAJ,GAAgB,GAAhB;AACA5C,MAAAA,GAAG,CAACqB,SAAJ,CAAc,KAAKV,IAAnB,EAAyB,KAAKC,IAA9B;AACAZ,MAAAA,GAAG,CAACqC,MAAJ,CAAW,CAAX,EAAc,CAAd;AACArC,MAAAA,GAAG,CAACsC,MAAJ,CAAW,KAAKQ,IAAL,GAAY,EAAvB,EAA2B,KAAKE,IAAL,GAAY,EAAvC;AACAhD,MAAAA,GAAG,CAACuB,MAAJ;AACAvB,MAAAA,GAAG,CAACwB,OAAJ;AACD;;;iCAEYhB,GAAGC,GAAG;AACjB,WAAKqC,IAAL,GAAYtC,CAAC,GAAG,KAAKG,IAArB;AACA,WAAKqC,IAAL,GAAYvC,CAAC,GAAG,KAAKG,IAArB;AAEA,UAAMsC,GAAG,GAAGnC,IAAI,CAACoB,IAAL,CAAUpB,IAAI,CAACqB,GAAL,CAAS,KAAKU,IAAd,EAAoB,CAApB,IAAyB/B,IAAI,CAACqB,GAAL,CAAS,KAAKY,IAAd,EAAoB,CAApB,CAAnC,CAAZ;AACA,WAAKF,IAAL,GAAY,KAAKA,IAAL,GAAYI,GAAxB;AACA,WAAKF,IAAL,GAAY,KAAKA,IAAL,GAAYE,GAAxB;AACD;;;yBAEInB,MAAM;AAAA,UACDS,EADC,GACkBT,IADlB,CACDS,EADC;AAAA,UACGE,EADH,GACkBX,IADlB,CACGW,EADH;AAAA,UACOD,EADP,GACkBV,IADlB,CACOU,EADP;AAAA,UACWE,EADX,GACkBZ,IADlB,CACWY,EADX;AAGT,UAAMQ,EAAE,GAAG,KAAKxC,IAAhB;AACA,UAAMyC,EAAE,GAAG,KAAKxC,IAAhB;AAEA,UAAMyC,EAAE,GAAG,KAAK1C,IAAL,GAAY,KAAKmC,IAA5B;AACA,UAAMQ,EAAE,GAAG,KAAK1C,IAAL,GAAY,KAAKoC,IAA5B;AAEA,UAAMO,GAAG,GAAG,CAACf,EAAE,GAAGE,EAAN,KAAaU,EAAE,GAAGE,EAAlB,IAAwB,CAACb,EAAE,GAAGE,EAAN,KAAaQ,EAAE,GAAGE,EAAlB,CAApC,CATS,CAUT;;AACA,UAAIE,GAAG,KAAK,CAAZ,EAAe;AACb;AACD;;AAED,UAAMC,CAAC,GAAG,CAAC,CAAChB,EAAE,GAAGW,EAAN,KAAaC,EAAE,GAAGE,EAAlB,IAAwB,CAACb,EAAE,GAAGW,EAAN,KAAaD,EAAE,GAAGE,EAAlB,CAAzB,IAAkDE,GAA5D;AACA,UAAME,CAAC,GAAG,EAAG,CAACjB,EAAE,GAAGE,EAAN,KAAaD,EAAE,GAAGW,EAAlB,IAAwB,CAACX,EAAE,GAAGE,EAAN,KAAaH,EAAE,GAAGW,EAAlB,CAA3B,IAAoDI,GAA9D;;AAEA,UAAIC,CAAC,IAAI,CAAL,IAAUA,CAAC,IAAI,CAAf,IAAoBC,CAAC,IAAI,CAA7B,EAAgC;AAC9B;AACD;;AAED,aAAO;AACLjD,QAAAA,CAAC,EAAEgC,EAAE,GAAGgB,CAAC,IAAId,EAAE,GAAGF,EAAT,CADJ;AAEL/B,QAAAA,CAAC,EAAEgC,EAAE,GAAGe,CAAC,IAAIb,EAAE,GAAGF,EAAT;AAFJ,OAAP;AAID;;;;;;AAGH,IAAMV,IAAI,GAAG,IAAIQ,QAAJ,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,EAA4B,GAA5B,CAAb;AACA,IAAMmB,KAAK,GAAG,IAAInB,QAAJ,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,EAA4B,GAA5B,CAAd;AACA,IAAMoB,KAAK,GAAG,IAAIpB,QAAJ,CAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,EAA4B,GAA5B,CAAd;AACA,IAAMd,KAAK,GAAG,CACZM,IADY,EAEZ2B,KAFY,EAGZC,KAHY,CAAd;AAMA,IAAMC,QAAQ,GAAG,IAAIlD,QAAJ,EAAjB;;AAEA,IAAMmD,MAAM,GAAG,SAATA,MAAS,GAAM;AACnB7D,EAAAA,GAAG,CAAC8D,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoB,GAApB,EAAyB,GAAzB;AACA9D,EAAAA,GAAG,CAAC+D,SAAJ,GAAgB,OAAhB;AACA/D,EAAAA,GAAG,CAACgE,QAAJ,CAAa,CAAb,EAAgB,CAAhB,EAAmB,GAAnB,EAAwB,GAAxB;AACAvC,EAAAA,KAAK,CAACC,OAAN,CAAc,UAAAK,IAAI,EAAI;AACpBA,IAAAA,IAAI,CAACkC,IAAL;AACD,GAFD;AAIAL,EAAAA,QAAQ,CAACM,IAAT,CAAczC,KAAd;AACAmC,EAAAA,QAAQ,CAACK,IAAT;AACAL,EAAAA,QAAQ,CAACC,MAAT,GAVmB,CAWnB;AACA;AACF;AACE;AACA;AACE;AACA;AACA;AACA;AACA;AACA;AACF;AACD,CAvBD;;AAyBA,IAAMM,IAAI,GAAG,SAAPA,IAAO,GAAM;AACjBN,EAAAA,MAAM;AACNxD,EAAAA,MAAM,CAAC+D,qBAAP,CAA6BD,IAA7B;AACD,CAHD;;AAKA9D,MAAM,CAAC+D,qBAAP,CAA6BD,IAA7B","file":"raycasting-proto.e31bb0bc.js","sourceRoot":"..","sourcesContent":["export const map = [\n  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,2,2,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,3,0,0,0,3,0,0,0,1],\n  [1,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,2,2,0,2,2,0,0,0,0,3,0,3,0,3,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,0,0,0,5,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],\n  [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\n]\n","import { map } from './map';\n\nconst MAP_ROWS = 24;\nconst MAP_COLS = 24;\n\nconst canvas = document.querySelector('#game-canvas');\nconst ctx = canvas.getContext('2d');\nctx.strokeStyle = 'white'; \n\nlet mouseX = 0;\nlet mouseY = 0;\n\nwindow.addEventListener('mousemove', e => {\n  mouseX = e.x;\n  mouseY = e.y;\n});\n\nclass Particle {\n  constructor() {\n    this.posX = 100;\n    this.posY = 200;\n    this.rays = [];\n    for (let i = -Math.PI; i < Math.PI; i+=Math.PI / 100) {\n      this.rays.push(new Ray(this.posX, this.posY, i));\n    }\n  }\n\n  draw() {\n    ctx.save();\n    ctx.beginPath();\n    ctx.translate(this.posX, this.posY);\n    ctx.arc(0, 0, 2, 0, 2 * Math.PI);\n    ctx.stroke();\n    ctx.restore();\n    // for (let i = 0; i < this.rays.length; i++) {\n      // this.rays[i].draw();\n    // }\n  }\n\n  update() {\n    this.posX = mouseX;\n    this.posY = mouseY;\n    this.rays = [];\n    for (let i = -Math.PI; i < Math.PI; i += Math.PI / 100) {\n      this.rays.push(new Ray(this.posX, this.posY, i));\n    }\n  }\n\n  look(walls) {\n    this.rays.forEach(ray => {\n      let closest = null;\n      let record = Infinity;\n      walls.forEach(wall => {\n        const pt = ray.cast(wall);\n        if (pt) {\n          const d = Math.sqrt(Math.pow(this.posX - pt.x, 2) + Math.pow(this.posY - pt.y ,2));\n          if (d < record) {\n            record = d;\n            closest = pt;\n          }\n\n        }\n      });\n\n      if (closest) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.translate(this.posX, this.posY);\n        ctx.moveTo(0, 0);\n        ctx.lineTo(closest.x - this.posX, closest.y - this.posY);\n        ctx.stroke();\n        ctx.restore();\n      }\n    });\n  }\n}\n\nclass Boundary {\n  constructor(x1, y1, x2, y2) {\n    this.x1 = x1;\n    this.y1 = y1;\n    this.x2 = x2;\n    this.y2 = y2;\n  }\n  draw() {\n    ctx.save();\n    ctx.beginPath();    \n    ctx.lineWidth = '3';\n    ctx.translate(this.x1, this.y1);\n    ctx.moveTo(0, 0);\n    ctx.lineTo(this.x2 - this.x1, this.y2 - this.y1);\n    ctx.stroke();\n    ctx.restore();\n  }\n}\n\nclass Ray {\n  constructor(x, y, angle) {\n    this.posX = x;\n    this.posY = y;\n    this.dirX = Math.sin(angle);\n    this.dirY = Math.cos(angle);\n  }\n\n  draw() {\n    ctx.save();\n    ctx.beginPath();\n    ctx.lineWidth = '1';\n    ctx.translate(this.posX, this.posY);\n    ctx.moveTo(0, 0);\n    ctx.lineTo(this.dirX * 50, this.dirY * 50)\n    ctx.stroke();\n    ctx.restore();\n  }\n\n  setDirection(x, y) {\n    this.dirX = x - this.posX;\n    this.dirY = y - this.posY;\n\n    const len = Math.sqrt(Math.pow(this.dirX, 2) + Math.pow(this.dirY, 2));\n    this.dirX = this.dirX / len;\n    this.dirY = this.dirY / len;\n  }\n\n  cast(wall) {\n    const { x1, x2, y1, y2 } = wall;\n\n    const x3 = this.posX;\n    const y3 = this.posY;\n\n    const x4 = this.posX + this.dirX;\n    const y4 = this.posY + this.dirY;\n\n    const den = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n    // ray and wall are parallel\n    if (den === 0) {\n      return;\n    }\n\n    const t = ((x1 - x3) * (y3 - y4) - (y1 - y3) * (x3 - x4)) / den;\n    const u = - ((x1 - x2) * (y1 - y3) - (y1 - y2) * (x1 - x3)) / den;\n\n    if (t <= 0 || t >= 1 || u <= 0) {\n      return;\n    }\n\n    return {\n      x: x1 + t * (x2 - x1),\n      y: y1 + t * (y2 - y1)\n    };\n  }\n}\n\nconst wall = new Boundary(300, 100, 300, 300);\nconst wall2 = new Boundary(300, 100, 200, 300);\nconst wall3 = new Boundary(100, 200, 300, 100);\nconst walls = [\n  wall,\n  wall2,\n  wall3,\n];\n\nconst particle = new Particle();\n\nconst update = () => {\n  ctx.clearRect(0, 0, 800, 600);\n  ctx.fillStyle = 'black';\n  ctx.fillRect(0, 0, 800, 600);\n  walls.forEach(wall => {\n    wall.draw();\n  });\n\n  particle.look(walls);\n  particle.draw();\n  particle.update();\n  // ray.draw();\n  // ray.setDirection(mouseX, mouseY);\n// //\n  // let pt = ray.cast(wall);\n  // if (pt) {\n    // ctx.save();\n    // ctx.beginPath();\n    // ctx.translate(pt.x, pt.y);\n    // ctx.arc(0, 0, 10, 0, 2 * Math.PI);\n    // ctx.stroke();\n    // ctx.restore();\n  // }\n};\n\nconst loop = () => {\n  update();\n  window.requestAnimationFrame(loop);\n};\n\nwindow.requestAnimationFrame(loop);\n"]}